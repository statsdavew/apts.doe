---
title: "APTS Design of Experiments - Practical 2"
subtitle: "September 2021"
author: "Dave Woods (<D.Woods@southampton.ac.uk> ; <http://www.southampton.ac.uk/~davew>) <br> Statistical Sciences Research Institute, University of Southampton"
output: 
#beamer_presentation
pdf_document:
#  html_document:
    theme: null
    highlights: null
bibliography: ../notes/apts_doe.bib
#csl: american-statistical-association.csl
number_sections: true
---

\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\btheta}{\boldsymbol{\theta}}
\newcommand{\bbeta}{\boldsymbol{\beta}}
\newcommand{\bvarepsilon}{\boldsymbol{\varepsilon}}
\newcommand{\by}{\boldsymbol{y}}
\newcommand{\rT}{\mathrm{T}}
\newcommand{\Var}{\operatorname{Var}}


<style>
pre {
  font-size: 15px;
}
</style>

```{r, echo=FALSE}
options(width=80)
library(knitr)
library(xtable)
set.seed(1)
knit_hooks$set(no.main = function(before, options, envir) {
    if (before) par(mar = c(4.1, 4.1, 1.1, 1.1), pty = "s")  # smaller margin on top
})
opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
```

In this practical session, you will design and analyse a computer experiment. Feel free to also use the practical sessions to understand and reproduce results from the notes.

<!-- Computer experiments -->
**Computer experiments**  
A common mathematical model used to demonstrate computer experiment methodology in the literature describes the flow of ground water through a borehole from an upper aquifer to a lower aquifer separated by a impermeable rock layer. The model has eight input variables:

  - $r_w \in [0.05, 0.15]$: radius of the borehole ($m$)
  - $r \in [100, 50000]$: radius of infuence ($m$)
  - $T_u \in [63070, 115600]$: transmissivity of the upper aquifer ($m^2/yr$)
  - $H_u \in [990, 1110]$: potentiometric head of the upper aquifer ($m$)
  - $T_l \in [63.1, 116]$: transmissivity of the lower aquifer ($m^2/yr$)
  - $H_l \in [700, 820]$: potentiometric head of the lower aquifer ($m^2/yr$)
  - $L \in [1120, 1680]$: length of the borehole ($m$)
  - $K_w \in [9855, 12045]$: hydraulic conductivity of borehole ($m/yr$)

The output from the model is $y$, water flow rate ($m^3/yr$). The function <tt>borehole</tt> implements this model. The input to the model should be a numeric vector of length 8, giving values for the different input variables on the ranges defined above.

Design a suitable computer experiment, use the <tt>borehole</tt> function to perform the experiment, and fit a Gaussian process (GP) emulator. From the GP output, which variables look to have most impact on the response?

(I would suggest you fit the Gaussian process with all input variables scaled to $[0,1]$ to improve interpretability).

The borehole function is taken from the [Virtual Library of Simulation Experiments](https://www.sfu.ca/~ssurjano/). Choose another test function, and design and analyse the computer experiment.


